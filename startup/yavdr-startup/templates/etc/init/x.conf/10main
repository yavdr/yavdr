start on stopped displaydevice
stop on runlevel [016]

<?cs if:(!?vdr.frontend || vdr.frontend != "headless") ?>

respawn

env XORGCONFIG=/etc/X11/xorg.conf.yavdr
export XORGCONFIG

exec /usr/bin/X :1 vt9

post-start script
#while ! DISPLAY=:1 xset -q; do sleep 0.1 ; done
if [ "x$(dbget system.hardware.nvidia.detected)" = "x1" ]; then
    # set overscan compensation if set
    COMP=`dbget system.hardware.nvidia.overscan`

    if [ ! -z "$COMP" ]; then
         [ -e /usr/bin/nvidia-settings ] && DISPLAY=:1 /usr/bin/nvidia-settings -a OverscanCompensation=$COMP
    fi
fi
DISPLAY=:1 hsetroot -center /usr/share/yavdr/images/yavdr_logo.png
end script

<?cs /if ?>

